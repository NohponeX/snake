define("util",["require"],function(e){var t={isEncoded:function(e){return decodeURIComponent(e)!==e},getUrlVars:function(){var e={},t=window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(t,n,r){e[n]=r});return e}};return t}),define("directions",["require"],function(e){var t={left:[-1,0],right:[1,0],up:[0,-1],down:[0,1],opposite:function(e){return e===t.left?t.right:e===t.right?t.left:e===t.up?t.down:e===t.down?t.up:[e[0]*-1,e[1]*-1]}};return t}),define("snake",["directions"],function(e){var t={direction:e.up,positions:[],move:function(){var e=[this.positions[0][0]+this.direction[0],this.positions[0][1]+this.direction[1]];this.positions.pop(),this.positions.unshift(e)},eat:function(){var e=[this.positions[0][0]+this.direction[0],this.positions[0][1]+this.direction[1]];this.positions.unshift(e)}};return t}),define("Food",["snake","directions"],function(e,t){var n=function(e,t){this.direction=null,this.position=e,this.type=t||n.prototype.Types.passive};return n.prototype.Types={passive:1,hostile:4,life:2},n.prototype.chase=function(){this.direction=null;if(this.type===n.prototype.Types.life)return;var r=e.positions[0][0]-this.position[0],i=e.positions[0][1]-this.position[1],s,o=null;this.type===n.prototype.Types.passive&&Math.abs(r)<Math.abs(i)||this.type===n.prototype.Types.hostile&&Math.abs(r)>=Math.abs(i)?(s=r,r===0?this.direction=t.opposite(e.direction):this.direction=r>=0?t.right:t.left,o=i>=0?t.down:t.up):(s=i,i===0?this.direction=t.opposite(e.direction):this.direction=i>=0?t.down:t.up,o=r>=0?t.right:t.left),this.type===n.prototype.Types.passive&&(this.direction=t.opposite(this.direction),o=t.opposite(o)),this.willCollide(this.direction)&&(this.direction=null,console.log("avoiding collition with snake`s body"),this.willCollide(o)||(this.direction=o,console.log("use alternative direction"))),this.direction&&this.outOfBorders(this.direction)&&(console.log("outOfBorders"),this.direction=null,!this.outOfBorders(o)&&!this.willCollide(o)&&(this.direction=o))},n.prototype.move=function(){if(!this.direction)return;var e=this.type==n.prototype.Types.passive?5:2;if(Math.floor(Math.random()*e)===0)return;this.position[0]+=this.direction[0],this.position[1]+=this.direction[1]},n.prototype.willCollide=function(t){t||(t=[0,0]);var n=[this.position[0]+t[0],this.position[1]+t[1]];for(i=1;i<e.positions.length;++i)if(n[0]===e.positions[i][0]&&n[1]===e.positions[i][1])return!0;var r=require("game");return r.foods.some(function(e){if(e.position[0]===n[0]&&e.position[1]===n[1])return console.log("COLLIDE WITH OTHER FOOD"),!0})},n.prototype.outOfBorders=function(e){e||(e=[0,0]);var t=[this.position[0]+e[0],this.position[1]+e[1]],n=require("game");return t[0]<=1||t[1]<=1||t[0]>=n.width-1||t[1]>=n.height-1?!0:!1},n}),define("theme",[],function(){var e={snake:"#9C4150",snakeHead:"#580B17",food:"#FFCC00",foodHostile:"#E90B1D",foodLife:"#10C910",score:"#9C4150",border:"#2D2D2D",tail:"rgba(156, 65, 80, 0.75)"};return e}),define("audio",[],function(){var e={sounds:{},consume:function(){this.sounds.consume.play()},gameOver:function(){this.sounds.gameOver.play()},initialize:function(){this.sounds.consume=new Audio,this.sounds.consume.setAttribute("src","sounds/pick_up.ogg"),this.sounds.consume.repeat=!1,this.sounds.consume.loop=!1,this.sounds.consume.volume=.3,this.sounds.gameOver=new Audio,this.sounds.gameOver.setAttribute("src","sounds/game_over.ogg"),this.sounds.gameOver.repeat=!1,this.sounds.gameOver.loop=!1,this.sounds.gameOver.volume=.3}};return e}),define("game",["snake","Food","directions","theme","audio"],function(e,t,n,r,i){var s={interval:null,width:0,height:0,boxWidth:15,boxHeight:15,foods:[],score:0,gameOver:!0,clearBorder:!0,sounds:!0,paused:!1,level:0,canvas:null,canvasWidth:0,canvasHeight:0,context:null,levelSpeed:[200,199,197,196,194,191,189,186,183,181,178,175,171,168,165,161,158,154,150,147,143,139,135,131,127,123,119,114,110,106,101,97,92,88,83,79,74,69,64,59,55,50,45,40,35],currentSpeed:0,snakeHeadImage:null,foodImage:null,setup:function(t,r){t&&(this.snakeHeadImage=t),r&&(this.foodImage=r),s.foods.length=0,this.width=Math.ceil(this.canvasWidth/this.boxWidth)-1,this.height=Math.ceil((this.canvasHeight-30)/this.boxHeight)-1,this.gameOver=!1,this.clearBorder=!0,e.direction=n.up,e.positions=[[Math.floor(Math.random()*(this.width-1))+1,Math.floor(Math.random()*(this.height-this.height/2)+this.height/2)]],e.eat(),e.eat(),s.score=0,s.level=1,s.currentSpeed=s.levelSpeed[s.level],s.interval=setInterval(s.tick,s.currentSpeed),s.drawScore()},initialize:function(){this.gameOver=!0,s.setup(),clearInterval(s.interval),s.draw(),s.drawGameover()},restart:function(){clearInterval(s.interval),s.setup()},pause:function(){s.paused=!0,s.drawPaused()},resetInterval:function(){s.interval&&clearInterval(s.interval),s.interval=setInterval(s.tick,s.currentSpeed)},resume:function(){s.paused=!1,this.resetInterval(),s.drawScore()},levelUp:function(){if(s.level+1>=s.levelSpeed.length)return;var e=t.prototype.Types.passive;for(var n=s.foods.length-1;n<s.level;++n)n>=Math.round(s.level/3)&&!0&&(e=t.prototype.Types.hostile),s.createFood(e);s.interval&&(clearInterval(s.interval),s.interval=null),s.currentSpeed=s.levelSpeed[Math.min(++s.level,s.levelSpeed.length-1)],s.interval=setInterval(s.tick,s.currentSpeed)},tick:function(){if(s.gameOver){i.gameOver(),clearInterval(s.interval),s.interval=null,s.drawScore(),s.drawGameover();return}if(s.paused){s.draw(),clearInterval(s.interval),s.interval=null;return}s.foods.length&&(s.level%2||!0)&&s.foods.forEach(function(e){e.chase(),e.move()}),e.move();var t;s.foods.length===0?s.createFood():(t=s.checkEatFood())>0&&(e.eat(),s.score+=t,s.drawScore(),i.consume(),s.score>s.level*3&&s.levelUp()),s.draw();if(s.checkWallCollusion()||s.checkSnakeCollusion())s.gameOver=!0;if(s.gameOver){i.gameOver(),clearInterval(s.interval),s.interval=null,s.drawScore(),s.drawGameover();return}},draw:function(){var n,i;if(s.clearBorder){s.context.clearRect(0,0,s.canvasWidth,this.boxHeight*s.height),s.context.fillStyle=r.border;for(n=0;n<=s.width;n++)for(i=0;i<=s.height;i++)(!i||!n||i===s.height||n===s.width)&&s.context.fillRect(this.boxWidth*n,this.boxHeight*i,this.boxWidth,this.boxHeight);s.clearBorder=!1}else s.context.clearRect(this.boxWidth,this.boxHeight,(s.width-1)*this.boxWidth,(s.height-1)*this.boxHeight);s.context.fillStyle=r.snakeHead,s.context.drawImage(this.snakeHeadImage,this.boxWidth*e.positions[0][0]+.5,this.boxHeight*e.positions[0][1]+.5,this.boxWidth-1,this.boxHeight-1),s.context.fillStyle=r.snake;for(n=1;n<e.positions.length-1;++n)s.context.fillRect(this.boxWidth*e.positions[n][0]+.5,this.boxHeight*e.positions[n][1]+.5,this.boxWidth-1,this.boxHeight-1);n=e.positions.length-1,s.context.fillStyle=r.tail,s.context.fillRect(this.boxWidth*e.positions[n][0]+.5,this.boxHeight*e.positions[n][1]+.5,this.boxWidth-1,this.boxHeight-1),s.foods.forEach(function(e){e.type===t.prototype.Types.hostile?(s.context.fillStyle=r.foodHostile,s.context.fillRect(s.boxWidth*e.position[0],s.boxHeight*e.position[1],s.boxWidth,s.boxHeight)):e.type===t.prototype.Types.life?(s.context.fillStyle=r.foodLife,s.context.fillRect(s.boxWidth*e.position[0],s.boxHeight*e.position[1],s.boxWidth,s.boxHeight)):s.context.drawImage(s.foodImage,s.boxWidth*e.position[0],s.boxHeight*e.position[1],s.boxWidth,s.boxWidth)})},drawScore:function(){s.context.clearRect(0,(s.height+1)*this.boxHeight,s.canvasWidth,s.canvasHeight-(s.height+1)*this.boxHeight),s.context.fillStyle=r.score,s.context.fillText("Score: "+this.score+" Level: "+this.level,this.boxWidth,(s.height+2)*this.boxHeight)},drawGameover:function(){s.context.fillStyle=r.score,s.context.fillText("Game over press Enter to play",this.boxWidth+175,(s.height+2)*this.boxHeight)},drawPaused:function(){s.context.fillStyle=r.score,s.context.fillText("Game paused press p to play",this.boxWidth+175,(s.height+2)*this.boxHeight)},checkSnakeCollusion:function(){for(var t=1;t<e.positions.length;++t)if(e.positions[t][0]===e.positions[0][0]&&e.positions[t][1]===e.positions[0][1])return!0;return!1},checkWallCollusion:function(){var t=e.positions[0][0],n=e.positions[0][1];return!t||!n||t>=s.width||n>=s.height?!0:!1},checkEatFood:function(){var n=[],r={};for(var i in t.prototype.Types)r[t.prototype.Types[i]]=0;return s.foods.forEach(function(i,o){e.positions.some(function(e){return e[0]===i.position[0]&&e[1]===i.position[1]})?i.type===t.prototype.Types.passive?n.push(o):i.type===t.prototype.Types.life?n.push(o):i.type===t.prototype.Types.hostile&&(s.gameOver=!0):++r[i.type]}),!s.gameOver&&n.length?(n.forEach(function(e){s.foods.splice(e,1)}),r[t.prototype.Types.passive]===0&&r[t.prototype.Types.life]===0&&(s.foods=s.foods.filter(function(e){return e.type===t.prototype.Types.passive})),n.length):0},createFood:function(n){n=typeof n=="undefined"?t.prototype.Types.passive:n,n===t.prototype.Types.passive&&Math.round(Math.random()*5)===0&&(n=t.prototype.Types.life);var r=0,i=0,o=!1,u=function(e){return e.position[0]===r&&e.position[1]===i?(o=!0,!0):!1};do{o=!1,r=Math.floor(Math.random()*(s.height-3))+2,i=Math.floor(Math.random()*(s.width-3))+2;if(!r||!i||r>=s.width||i>=s.height){o=!0;continue}for(var a=0,f=e.positions.length;a<f;++a)if(r===e.positions[a][0]&&i===e.positions[a][1]){o=!0;break}o||(o=s.foods.some(u))}while(o);var l=new t([r,i],n);s.foods.push(l)}};return s}),define("controls",["snake","game","directions"],function(e,t,n){var r={initialize:function(){document.onkeydown=function(r){switch(r.keyCode){case 37:case 65:e.direction===n.left?(t.tick(),t.resetInterval()):n.left!==n.opposite(e.direction)&&(e.direction=n.left),r.preventDefault();break;case 38:case 87:e.direction===n.up?(t.tick(),t.resetInterval()):n.up!==n.opposite(e.direction)&&(e.direction=n.up),r.preventDefault();break;case 39:case 68:e.direction===n.right?(t.tick(),t.resetInterval()):n.right!==n.opposite(e.direction)&&(e.direction=n.right),r.preventDefault();break;case 40:case 83:e.direction===n.down?(t.tick(),t.resetInterval()):n.down!==n.opposite(e.direction)&&(e.direction=n.down),r.preventDefault();break;case 13:t.gameOver&&(t.restart(),r.preventDefault());break;case 80:t.gameOver?(t.restart(),r.preventDefault()):t.paused?t.resume():t.pause(),r.preventDefault()}}}};return r}),define("controller",["util","game","audio","controls"],function(e,t,n,r){var i={initialize:function(i){var s="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAAA1BMVEVYCxel8h7eAAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==",o="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAAA1BMVEX/zAB+rZF1AAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==",u=e.getUrlVars();u.head&&(s=e.isEncoded(u.head)?decodeURIComponent(u.head):u.head),u.food&&(o=decodeURIComponent(u.food));var a=new Image;a.src=s;var f=new Image;f.src=o,t.canvas=window.document.getElementById(i),t.context=t.canvas.getContext("2d"),t.context.font="14px monospace",t.canvasWidth=t.canvas.offsetWidth,t.canvasHeight=t.canvas.offsetHeight,n.initialize(),r.initialize(),t.setup(a,f),t.pause()}};return i}),require(["controller","theme"],function(e,t){var n=window.document.getElementById("canvas"),r=window.innerWidth,i=window.innerHeight,s=Math.round(r*.6/15)*15,o=Math.round(i*.75/15)*15;n.width=s,n.height=o,window.document.querySelector("#foods .passive > span").style["background-color"]=t.food,window.document.querySelector("#foods .hostile > span").style["background-color"]=t.foodHostile,window.document.querySelector("#foods .life > span").style["background-color"]=t.foodLife,e.initialize("canvas")}),define("main",function(){});